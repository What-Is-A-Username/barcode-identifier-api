# File system description

Barrel stores files in two directories, based on how accessible they are to users.

## Database files (`/var/data/library/`)

Barrel stores library and database files, such as the files made from running `makeblastdb`, within the `/var/data/library/` directory. Within the `/var/data/library` directory, each library has a subdirectory named using its ID. Furthermore, each BLAST database within the library has its own subdirectory, also named by ID.

Consider the following example:
```
└─ /var
  └─ /data
    └─ /library
      └─ /277b7e06-acd4-41ef-b27d-4039d5218abd
        └─ /7ad24bfe-0fe7-4172-8aae-e8ea6511ea6b
          ├─ /database.fasta
          ├─ /database.ndb
          ├─ /database.nhr
          ├─ /database.nin
          ├─ /database.nog
          ├─ /database.not
          ├─ /database.nsq
          ├─ /database.ntf
          └─ /database.nto
```
So the directory `/var/data/library/277b7e06-acd4-41ef-b27d-4039d5218abd/7ad24bfe-0fe7-4172-8aae-e8ea6511ea6b/` contains the output files from running `makeblastdb` for the BLAST database with ID `7ad24bfe-0fe7-4172-8aae-e8ea6511ea6b` belonging to library `277b7e06-acd4-41ef-b27d-4039d5218abd`.

## Run files (`/var/data/runs/`)

Barrel stores the job submissions and all the associated output results in the `/var/data/runs/` file.

Consider the following example:
```
└─ /var
  └─ /data
    └─ /runs
      └─ /08c6fd02-c88a-42e9-9219-4ddd68db9a26
        ├─ alignment_query.fasta
        ├─ classification.tsv
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-clustal_num.clustal_num
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln.out.txt
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-phylotree.ph
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln.pim.pim
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-sequence.txt
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-submission.params
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln.tree.dnd
        ├─ /k2p_matrix.phy
        ├─ /query.fasta
        └─ /results.txt
```

The above example features the file structure for a run with ID `08c6fd02-c88a-42e9-9219-4ddd68db9a26`.
- `alignment_query.fasta` has all the sequences submitted for a multiple sequence alignment of query sequences and hits, if submitter indicated for alignments to be performed.
- files beginning with `clustalo-` correspond to output from running ClustalOmega, if the submitter indicated for alignment(s) to be performed.
- `query.fasta` contains the submitted sequences in fasta format
- `results.txt` contains the BLAST results in tabular format
  - columns are: query acc.ver, subject acc.ver, % identity, alignment length, mismatches, gap opens, q. start, q. end, s. start, s. end, evalue, bit score
- `k2p_matrix.phy` contains a matrix of the Kimura-2-parameter distances between the sequences aligned from `alignment_query.fasta`. This is only generated if submitter indicated for hit tree / alignment to be performed.

## Static run files (`/vol/static/runs/`)

Some of the downloadable results of runs which are downloadable are found under `/vol/static/runs`, with each run having a subdirectory named using its ID. These files are a subset of those found under `/var/data/runs/` and are present here again only to make them publicly downloadable.
```
└─ /vol
  └─ /static
    └─ /runs
      └─ /08c6fd02-c88a-42e9-9219-4ddd68db9a26
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-clustal_num.clustal_num
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-phylotree.ph
        ├─ /clustalo-R20230605-043203-0253-26477845-p1m.aln.pim.pim
        └─ /clustalo-R20230605-043203-0253-26477845-p1m.aln-sequence.txt
```

## Static web files (.html, .js, .css)

These files are autogenerated files and images used to render the website, and are served over the web from the NGINX reverse proxy container. They are present in various locations, but will rarely need to be modified.
- `/vol/static/`
- `/frontend`



